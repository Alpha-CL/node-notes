# mysql introduction

#### intoduction

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * 数据库
 * 
 * 
 * 
 */

1) 持久的存储数据( 数据存储在硬盘文件中 )

2) 备份和恢复数据

3) 快速的存储数据

4) 权限控制


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### data type

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * 关系数据库
 * 
 * 
 * 
 */

特点: 以表和表的关联构成的数据结构

优点: 能表达复杂的数据关系
     强大的查询语言，能精确查找想要的数据

缺点: 读写性能比较差，尤其是海量数据的读写
     数据结构比较死板
     
用途: 存储结构复杂的数据

代表: Oracle, MySql, Sql Server ...


//-------------------------------------------------------------------------------------------------------------------//


/**
 * 非关系型数据库
 * 
 * 
 * 
 */

特点: 以及其简单的结构存储数据
     文档型
     键值对
     
优点: 格式灵活
     海量数据读写效率很高

缺点: 难以表示复杂的数据结构
     对于复杂查询效率不好

用途: 存储结构简单的数据

代表: MongoDB, Redis, Membase ...


//-------------------------------------------------------------------------------------------------------------------//


/**
 * 面对对象数据库
 * 
 * 
 * 
 */


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### install mysql

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * MySql                // 关系型数据库( 瑞典 MySql AB，已被 Oracle 收购 )
 * 
 * 
 * 开源, 轻量, 快速
 */


//-------------------------------------------------------------------------------------------------------------------//


/**
 * install mysql
 * 
 * 
 * 
 */


https://dev.mysql.com/downloads/mysql/


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


/** mysql 中的命令必须以 ";" 结尾 **/


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


mysql.server start                              // 开启

mysql.server stop                               // 停止

mysql.server restart                            // 重启

mysql.server status                             // 查看状态

mysql --verbose --help | grep my.cnf            // 查看 mysql 的配置文件( 返回根据优先级执行的 系统配置文件路径 )


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


show variables like 'char%';                    // 查看编码
show variables like 'character%';


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

## mysql@8.0+ basic command

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * SQL          // Structured Query Language 结构化查询语言
 * 
 * 
 * 大部分关系型数据，拥有着基本一致的 SQL 语法
 */

* DDL: Data Definition Language 数据定义语言
  ( 操作数据库对象 )

* DML: Data Manipulation Lauguage 数据操控语言
  ( 操作数据库的记录 )

* DCL: Data Control Lauguage 数据控制语句
  ( 操作用户权限 )


//-------------------------------------------------------------------------------------------------------------------//


/**
 * quit mysql
 * 
 * 
 * 退出
 */

1) quit;

2) exit;

3) \q;


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


/**
 * 查询当前用户
 * 
 * 
 */

selct user();

select current_user();


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


/**
 * view version
 * 
 * 
 * 查看版本
 */

// global

mysql --version


// in mysql

status

select version();


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### database

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/** databases basic command **/


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


show databases;                 // 展示所有

create [database];              // 创建单个

drop [database];                // 删除单个

use [database];


//-------------------------------------------------------------------------------------------------------------------//


/** data_type **/


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


bit: 占 1 位，0 或 1，true 或 false

int: 占 32 位，整数

decimal(M, N): 能精确计算的实数，M 是总的数字位数，N 是小数位数

char(n): 固定长度位 n 的字符

varchar: 长度可变，最大长度位 n 的字符

text: 大量的字符

data: 仅日期

datatime: 日期和时间

time: 仅时间


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

## table

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * 使用某个数据库，并查看当前数据库下有哪些表
 * 
 * 
 * 
 */

show tables;                    // 显示指定数据库中的表

drop table [tablename];         // 删除指定表


//-------------------------------------------------------------------------------------------------------------------//


/** Data Manipulation Language 数据操控语言 **/


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


1) CREATE               // 增

insert into `table_name` ( `col_key`, `col_key`, `col_key` ... )            // `` 为了和关键字区别
value ( 'col_val', 'col_val', 'col_val' ... ),                              // 依次对应列的值
value ( 'col_val', 'col_val', 'col_val' ... ),
value ( 'col_val', 'col_val', 'col_val' ... );                              // 可依次增加多行数据


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


2) RETRIEVE             // 查


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


3) UPDATE               // 改

update `table_name` set `col_key` = 'col_val'                               //
where [condition];


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


4) DELETE               // 删

delete from `table_name`
where [condition];


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


5) CRUD



///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

### RETRIEVE( 查 )

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

 
/** 运行顺序 **/


FROM `table` => WHERE [condition] => SELECT [col] => ORDER BY col_key asc/desc => LIMIT


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### select

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * select [col_condition] from [table];
 * 
 * 
 * [, col_key]                      // 搜索多列
 * col_key as col_newkey            // 搜索指定列，并重命名改列
 * *                                // 搜索所有列
 */
 
SELECT col_key, col_key FROM `table`;               // 在指定 table 中搜索指定 col_key

SELECT col_key as col_newkey FROM `table`;          // 在指定 table 中搜索指定 col_key 并重命名为 col_newkey

SELECT * FROM `table`;                              // 搜索指定 table 中的所有 col

SELECT DISTINCT ...;                                // 去重


//-------------------------------------------------------------------------------------------------------------------//


/**
 * CASE ... END;
 * 
 *
 * 
 */

CASE 
WHEN col_key ? xxx THEN 'val_01'                    // if (col_key ? xxx) { col_key = val_01 }
WHEN col_key ? xxx THEN 'val_02'                    // else if (col_key ? xxx) { col_key = val_02 }  
ELSE 'val_03'                                       // else{ col_key = val_03 }
END col_newKey,                                     // 可重命名 col_key


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### from

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * 
 * 
 * 
 * 
 */


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### where

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * where
 * 
 * 
 * 
 */

=                   // WHERE col_key = val;

in                  // WHERE [col_key] in [ val_01, val_02 ... ];

is                  // WHERE cal_key IS NULL;               // 针对 null
                    // WHERE cal_key IS NOT NULL;

>, < , <=, >=       // 

beteeen             // WHERE col_key BETWEEN min AND max;

like                // WHERE col_key like '%query%';            // 模糊匹配: '% + query +  %'
                                                                // %: 任意字符; _: 匹配一个任意字符

and                 // &&: 并且           ( and 优先级高于 or )

or                  // ||: 或者

()                  // 组合条件


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### order by

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * order by
 * 
 * 
 * 
 */


ORDER BY col_key ASC/DESC;                                  // asc( def ): 升序; desc: 降序;
   
ORDER BY col_key_01 asc/desc, col_key_02 ASC/DESC;          // 按照多个排序条件筛选                          


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### limit

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * limit
 * 
 * 
 * 
 */


LIMIT jump_num, select_num;             // 跨越 jump_num 个数据，后取 select_num 个数据


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### example

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


// 模拟登陆查询
// 查询 账号为 admin，密码为 123456

SELECT * FROM `user`
WHERE loginid = 'admin' and loginpwd = '1234456';


//-------------------------------------------------------------------------------------------------------------------//


// 查询员工表
// 根据员工入职时间降序排序，并且使用分页查询第二页( 每页 10 条数据 )

SELECT * FROM employee
ORDER BY employee.joinDate desc
LIMIT 10, 10;


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


// 分页公式( page: 当前页，pagesize: 页容量 )

LIMIT (page - 1)*pagesize, pagesize;


//-------------------------------------------------------------------------------------------------------------------//


// 查询工资最高的女员工

SELECT * FROM emplyee
WHERE ismale = 0
ORDER BY salary DESC
LIMIT 0, 1;


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### 全连接-笛卡尔积

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


// 全连接-笛卡尔积

SELECT * FROM `table_01`, `table_02`;

=> table_03;        // 将 table_01 的每一行 与 table_02 的每一行 匹配
                    // 最终 table_03 包含 table_02 * table_02


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


// 创建一张 team 表，记录足球对的对阵表

SELECT t1.name 主场, t2.name 客场
From team AS t1, team AS t2
WHERE t1.name != t2.name;


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### 全连接( 左外连接: left join & 右外连接: right join )

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * [mian condition] LEFT JOIN [match condition]             // 以左边的条件为主
 * 
 * 
 * 以左边的条件为主要条件，匹配右边的条件
 *
 ** 若左边的条件无匹配项，则至少出现一次左边条件( 此时右边条件为 空 )
 */
 

//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


eg:

SELECT *
FROM [mian condition] LEFT JOIN [match condition]
on [connection condition];                                  // 以什么条件连接表


//-------------------------------------------------------------------------------------------------------------------//


/**
 * [match condition] RIGHT JOIN [main condition]            // 以右边的条件为主
 * 
 * 
 * 以右边的条件为主要条件，匹配左边的条件
 * 
 ** 若右边的条件无匹配项，则至少出现一次右边条件( 此时左边条件为 空 )
 */


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


eg:

SELECT *
FROM [match condition] RIGHT JOIN [main condition]
on [connection condition];                                  // 以什么条件连接表


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```


#### 内连接: inner join

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * [left condition] INNER JOIN [right condition]            // 必须同时满足左右条件
 * 
 * 
 * 互相匹配，并同时满足左右条件
 * 
 ** 未匹配到的条件，则不显示
 */


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


eg:

SELECT *
FROM [left condition] INNER JOIN [right condition]
on [connection condition];                                  // 以什么条件连接表


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

### table relationship

#### 主键

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * 主键       // id
 * 
 * 
 * 根据设计原则，每张表都要有 主键
 */

// 主键必须满足的要求

1) 唯一

2) 无法更改

3) 无业务含义


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


// 内键常规配置

Name    Type    Length    Decimals    Not Null    Virtual    Key    Comment

id      init                          true(def)              key1               [ auto Increment ]


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### 外键

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * 外键
 * 
 * 
 * 将当前表的 某列 与另一张表的 某列 形成映射关系，从而保证两列的数据统一，并避免了代码冗余
 * 
 * 外键 会连接到 另一张表( 或自己 )的 主键
 */


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### 表关系

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * 一对一
 * 
 * 
 * '一个 A' 对应 '一个 B'，'一个 B' 对应 '一个 A'
 * 
 ** 将任意一张表的 主键 "同时设置为" 外键
 */

eg: 

user.id <==> userinfo.id


//-------------------------------------------------------------------------------------------------------------------//


/**
 * 一对多
 * 
 * 
 * '一个 A' 对应 '一个 B'，'一个 B' 对应 '一个 A'
 * A 和 B 是 '一对多'，B 和 A 是 '多对一'
 * 
 ** 在多一端的表上设置 外键，对应到另一张表的 主键
 */

eg:

one class <==> more user

one user <==> more essay


//-------------------------------------------------------------------------------------------------------------------//


/**
 * 多对多
 * 
 * 
 * '一个 A' 对应 '多个 B'，'一个 B' 对应 '多个 A'
 *
 ** 需新建一张关系表，关系表至少包含 '两个外建'，分别对应到 两张表
 */

eg: 

more teacher <==> more student


//-------------------------------------------------------------------------------------------------------------------//


/**
 * 表设置三大规范
 * 
 * 
 * 
 */

1) 数据库表的每一列都是 '不可分割' 的原子数据项                 // 当前列的内容无法再分割

    eg: 地址无法分割...

2) 非主键列 必须依赖 主键列

    eg: student.id <==> banner.id                       // 依赖无意义数据列

3) 非主键列 必须直接依赖 主键列

    eg: student.id <==> class.id <--> class.name        // 不可以直接依赖 间接的数据


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

## function & group

#### function

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

/** Math **/

//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


ABS(x);                                 // 返回 x 的绝对值

CEILING(x);                             // 返回大于 x 的最小整数值

FLOOR(x);                               // 返回小于 x 的最大整数值

MOD(x, y);                              // 返回 x/y 的模( 余数 )

PI();                                   // 返回 PI 的值( 圆周率 )

RAND();                                 // 返回 0 到 1 内的随机值

ROUND(x, y);                            // 返回参数 x 的四舍五入的 y 位小数的值

TRUNCATE(x, y);                         // 返回数字 x 截短为 y 位小数的结果

... ...


//-------------------------------------------------------------------------------------------------------------------//

/** 聚合 **/

//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


AVG(col);                               // 返回指定 '列' 的 平均值

COUNT(col);                             // 返回指定 '列' 中 非NULL 的值的个数

MIN();                                  // 返回指定 '列' 的 最小值

MAX();                                  // 返回指定 '列' 的 最大值

SUM(col);                               // 返回指定 '列' 的 所有值之和

... ...


//-------------------------------------------------------------------------------------------------------------------//

/** 字符 **/

//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


CONCAT(s1, s2 ...);                     // 将 s1, s2 等连接成 字符串

CONCAT_WS(sep, s1, s2 ...);             // 将 s1, s2 等 连接成 字符串，并用 sep 字符分隔

TRIM(str);                              // 去除字符串首部和尾部的所有 空格

LTRIM(str);                             // 去除字符串 左边的 空格

RTRIM(str);                             // 去除字符串 右边的 空格

... ...


//-------------------------------------------------------------------------------------------------------------------//

/** 日期 **/

//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


CUTDATE();                              // 返回当前日期
CURRENT_DATE();

CURTIME();                              // 返回当前时间
CURRENT_TIME();

TIMESTAMPDIFF(part, data1, data2);      // 返回 data1 ～ data2 之间相隔 part 值
                                        // part 使用于指定的相隔的 年或月或日 等
// part: { MICROSECOND, SECOND, MINUTE, HOUR, DAY, WEEK, MONTH, QUARTER, YEAR }

... ...


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### custom function

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * 
 * 
 * 
 * 
 */


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### group

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * group
 * 
 * 
 * 分组后，仅能查询 分组的列 和 聚合列
 */


运行顺序:

FROM => JOIN...ON... => WHERE => GROUP BY => SELECT => HAVING => ORDER BY => LIMIT


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

## navicat premium

#### 

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * Fields
 * 
 * 
 * 
 */

Name                    // 数据列 '名称'

Type                    // 数据列 '类型'

Length                  // 数据 '正数' 长度

Deciimals               // 数据 '小数' 长度

Not Null                // 是否必填

Virtual                 // 虚拟

Key                     // 主键

Comment                 // 注释


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```